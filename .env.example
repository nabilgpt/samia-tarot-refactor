# SAMIA TAROT - Environment Variables Template
# Copy to .env.local and fill with actual values
# Follow: samia_tarot_backend_core_consolidated_master.md & samia_tarot_dev_implementation_pack.md

# ============================================================================
# Supabase Configuration
# ============================================================================
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your_anon_key_here
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key_here

# Database (for migrations)
DATABASE_URL=postgresql://postgres:password@db.your-project.supabase.co:5432/postgres

# ============================================================================
# Twilio Verify (OTP Authentication)
# Per samia_tarot_dev_implementation_pack.md
# ============================================================================
TWILIO_ACCOUNT_SID=ACbea6761e4edb95a695c739b733ff33e4

# Option A: Use Auth Token (simple)
TWILIO_AUTH_TOKEN=219d873751e40e55d5117bc84d5750bc
TWILIO_VERIFY_SID=VA8be8fc33969f9e3dbf23e16fd4174e00

# Option B: Use API Keys (production recommended)
# TWILIO_API_KEY=SKxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
# TWILIO_API_SECRET=your_api_key_secret_here
# VERIFY_SERVICE_SID=VAxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# ============================================================================
# SendGrid (Non-OTP Email)
# Per samia_tarot_dev_implementation_pack.md
# ============================================================================
SENDGRID_API_KEY=SG.1h37IS3LTB6fjgnzkUgKxgMIafkn0uQwFAB0_8sv9vhn8HESE_L42o7K_ZuMuwAhA
SENDING_DOMAIN=samiatarot.com
SENDGRID_SUBDOMAIN=em
SENDGRID_DOMAIN_ID=12345678

# ============================================================================
# LiveKit Cloud (Realtime Video/Audio)
# Per samia_tarot_dev_implementation_pack.md - Region Pinning: EU (Frankfurt)
# ============================================================================
LIVEKIT_WS_URL=wss://samiatarot-styelzay.livekit.cloud
LIVEKIT_API_KEY=APIbJDrDQGgjmfM
LIVEKIT_API_SECRET=4CbBsxDtGAhvBFi2fztzf4Bfdhglq6pWlDPGAc3xQIlB

# ============================================================================
# Stripe (Payment Provider - Primary)
# Per backend spec: SCA/3DS auto, auto-switch to Square after 2 consecutive failures
# ============================================================================
STRIPE_PUBLISHABLE_KEY=pk_test_xxxxxxxxxxxxxxxxxxxxxxxxxxxxx
STRIPE_SECRET_KEY=sk_test_xxxxxxxxxxxxxxxxxxxxxxxxxxxxx
STRIPE_WEBHOOK_SECRET=whsec_xxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# ============================================================================
# Square (Payment Provider - Fallback)
# Per backend spec: Auto-switch after 2 Stripe failures
# ============================================================================
SQUARE_ACCESS_TOKEN=your_square_access_token
SQUARE_APPLICATION_ID=your_square_application_id
SQUARE_LOCATION_ID=your_square_location_id
SQUARE_WEBHOOK_SECRET=your_square_webhook_secret
SQUARE_WEBHOOK_URL=https://your-domain.com/webhooks/square

# ============================================================================
# USDT (Crypto Payments)
# Per backend spec: TRC20 via Bybit, 2 confirmations standard, 6 high-value
# ============================================================================
BYBIT_API_KEY=your_bybit_api_key
BYBIT_API_SECRET=your_bybit_api_secret
USDT_NETWORK=TRC20
USDT_WALLET_ADDRESS=your_trc20_wallet_address
USDT_CONFIRMATIONS_STANDARD=2
USDT_CONFIRMATIONS_HIGH_VALUE=6

# ============================================================================
# n8n Orchestration
# Per backend spec: Queue mode with Redis, GENERIC_TIMEZONE=Asia/Beirut
# ============================================================================
N8N_HOST=https://n8n.your-domain.com
N8N_API_KEY=your_n8n_api_key
N8N_ENCRYPTION_KEY=your_n8n_encryption_key
GENERIC_TIMEZONE=Asia/Beirut

# Redis (for n8n queue mode)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=your_redis_password

# ============================================================================
# Google Translation API (for i18n automation)
# Per backend spec: n8n → Google Translation v3
# ============================================================================
GOOGLE_TRANSLATION_API_KEY=your_google_translation_api_key
GOOGLE_TRANSLATION_PROJECT_ID=your_gcp_project_id

# ============================================================================
# Storage Configuration
# ============================================================================
# Supabase Storage Buckets
STORAGE_BUCKET_ZODIAC_AUDIO=zodiac-audio
STORAGE_BUCKET_RECORDINGS=call-recordings
STORAGE_BUCKET_MEDIA=media-assets
STORAGE_BUCKET_INVOICES=invoices-private

# Egress destination for LiveKit recordings
STORAGE_EGRESS_URL=https://your-project.supabase.co/storage/v1/object/public/call-recordings

# ============================================================================
# Observability & Monitoring
# Per backend spec: Sentry + OpenTelemetry, 30-90d retention, PII scrubbing
# ============================================================================
SENTRY_DSN=https://xxxxx@xxxxx.ingest.sentry.io/xxxxx
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1

# OpenTelemetry
OTEL_EXPORTER_OTLP_ENDPOINT=https://your-otel-collector.com

# ============================================================================
# Push Notifications
# Per backend spec: Web Push (VAPID), Android (FCM), iOS (APNs)
# ============================================================================
# Web Push (VAPID)
VAPID_PUBLIC_KEY=your_vapid_public_key
VAPID_PRIVATE_KEY=your_vapid_private_key
VAPID_SUBJECT=mailto:support@samiatarot.com

# FCM (Android)
FCM_SERVER_KEY=your_fcm_server_key
FCM_SENDER_ID=your_fcm_sender_id

# APNs (iOS)
APNS_KEY_ID=your_apns_key_id
APNS_TEAM_ID=your_apns_team_id
APNS_KEY_PATH=./certs/apns-key.p8

# ============================================================================
# Security & CSP
# Per backend spec: Cloudflare + strict allowlists, no unsafe-inline
# ============================================================================
JWT_SECRET=your_jwt_secret_key_here
SESSION_SECRET=your_session_secret_here

# Cloudflare (for CSP and edge protection)
CF_ZONE_ID=your_cloudflare_zone_id
CF_API_TOKEN=your_cloudflare_api_token

# ============================================================================
# Application Configuration
# ============================================================================
NODE_ENV=development
PORT=3000

# Base URLs for each app (5 PWAs)
CLIENT_URL=http://localhost:3000
READER_URL=http://localhost:3001
MONITOR_URL=http://localhost:3002
ADMIN_URL=http://localhost:3003
SUPERADMIN_URL=http://localhost:3004

# Production URLs (uncomment for production)
# CLIENT_URL=https://app.samiatarot.com
# READER_URL=https://reader.samiatarot.com
# MONITOR_URL=https://monitor.samiatarot.com
# ADMIN_URL=https://admin.samiatarot.com
# SUPERADMIN_URL=https://superadmin.samiatarot.com

# ============================================================================
# Feature Flags
# ============================================================================
ENABLE_MFA_ENFORCEMENT=true
ENABLE_PASSKEYS=true
ENABLE_REWARDS=true
ENABLE_WALLET_CASHOUT=true
ENABLE_USDT_PAYMENTS=true
ENABLE_MANUAL_TRANSFERS=true

# ============================================================================
# Rate Limiting
# Per backend spec: 5 tries/10m, lock 15m
# ============================================================================
RATE_LIMIT_WINDOW_MS=600000
RATE_LIMIT_MAX_REQUESTS=5
RATE_LIMIT_LOCKOUT_MS=900000

# ============================================================================
# Localization
# Per backend spec: Default Asia/Riyadh timezone
# ============================================================================
DEFAULT_LOCALE=en
SUPPORTED_LOCALES=en,ar,fr
DEFAULT_TIMEZONE=Asia/Riyadh

# ============================================================================
# Business Rules (Per Backend Core Spec)
# ============================================================================
# Refund policy: refundable if ≥2h before appointment
REFUND_CUTOFF_HOURS=2

# Reader revenue share
READER_REVENUE_SHARE_PERCENT=50

# Rewards points (rating=50%, comment=50%, both=100%)
REWARD_POINTS_PER_RATING=50
REWARD_POINTS_PER_COMMENT=50
REWARD_POINTS_EXPIRY_DAYS=365

# Age gate (all countries)
MINIMUM_AGE=18

# Daily zodiac cleanup (purge >60 days)
ZODIAC_RETENTION_DAYS=60

# ============================================================================
# Development Only
# ============================================================================
DEBUG=false
LOG_LEVEL=info
NODE_TLS_REJECT_UNAUTHORIZED=1